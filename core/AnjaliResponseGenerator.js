/* ======================================================
   core/AnjaliResponseGenerator.js ‚Äî SINGLE FORWARD RULE
   PURPOSE:
   - ‡§π‡§∞ turn ‡§Æ‡•á‡§Ç EXACTLY ONE forward (‡§è‡§ï ‡§∏‡§µ‡§æ‡§≤/tease)
   - Soft MiniPlan (inclination) ‡§ï‡§æ ‡§π‡§≤‡•ç‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó
   - Over-talking ‡§∞‡•ã‡§ï‡§®‡§æ, playful timing ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡§®‡§æ
   ====================================================== */

(function (global) {
  "use strict";

  /* ===============================
     LIGHT REACTIONS (SHORT)
     =============================== */
  const REACTIONS = [
    "‡§π‡§Æ‡•ç‡§Æ‚Ä¶",
    "‡§Ö‡§ö‡•ç‡§õ‡§æ‚Ä¶",
    "‡§∏‡§Æ‡§ù ‡§∞‡§π‡•Ä ‡§π‡•Ç‡§Å‚Ä¶",
    "‡§†‡•Ä‡§ï ‡§π‡•à‚Ä¶"
  ];

  /* ===============================
     FORWARD BY INCLINATION (ONE ONLY)
     =============================== */
  const FORWARD_BY_INCLINATION = {
    travel: [
      "‡§Ö‡§≠‡•Ä ‡§ò‡•Ç‡§Æ‡§®‡•á ‡§ï‡§æ ‡§ñ‡•ç‡§Ø‡§æ‡§≤ ‡§∏‡§ö ‡§Æ‡•á‡§Ç ‡§Ü ‡§∞‡§π‡§æ ‡§π‡•à ‡§Ø‡§æ ‡§¨‡§∏ ‡§Ø‡•Ç‡§Å ‡§π‡•Ä?",
      "‡§Ö‡§ó‡§∞ ‡§Ö‡§≠‡•Ä ‡§¨‡§¶‡§≤‡§®‡§æ ‡§ö‡§æ‡§π‡•ã ‡§§‡•ã ‡§ï‡§ø‡§∏ ‡§§‡§∞‡§π ‡§ï‡•Ä ‡§ú‡§ó‡§π ‡§∏‡•ã‡§ö‡•ã‡§ó‡•á?"
    ],
    movie: [
      "‡§Ü‡§ú ‡§´‡§ø‡§≤‡•ç‡§Æ ‡§ï‡§æ ‡§Æ‡•Ç‡§° ‡§π‡§≤‡•ç‡§ï‡§æ ‡§π‡•à ‡§Ø‡§æ ‡§ï‡•Å‡§õ ‡§∏‡•ã‡§ö‡§®‡•á ‡§µ‡§æ‡§≤‡§æ?",
      "‡§§‡•Å‡§Æ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•á ‡§ú‡§º‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§ú‡•Å‡§°‡§º‡§§‡•á ‡§π‡•ã ‡§Ø‡§æ ‡§Æ‡§æ‡§π‡•å‡§≤ ‡§∏‡•á?"
    ],
    food: [
      "‡§Ö‡§≠‡•Ä ‡§ï‡•Å‡§õ ‡§π‡§≤‡•ç‡§ï‡§æ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§≤‡§ó‡•á‡§ó‡§æ ‡§Ø‡§æ ‡§™‡•á‡§ü ‡§≠‡§∞‡§ï‡§∞?",
      "‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ comfort food ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?"
    ],
    study: [
      "‡§Ö‡§≠‡•Ä ‡§™‡§¢‡§º‡§æ‡§à manageable ‡§≤‡§ó ‡§∞‡§π‡•Ä ‡§π‡•à ‡§Ø‡§æ ‡§≠‡§æ‡§∞‡•Ä?",
      "‡§ï‡§ø‡§∏ ‡§π‡§ø‡§∏‡•ç‡§∏‡•á ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡§æ ‡§§‡•Å‡§Æ‡•ç‡§π‡•á‡§Ç ‡§Ü‡§∏‡§æ‡§® ‡§≤‡§ó‡§§‡§æ ‡§π‡•à?"
    ],
    casual: [
      "‡§Ö‡§≠‡•Ä ‡§¨‡§∏ ‡§¨‡§æ‡§§‡•á‡§Ç ‡§ï‡§∞‡§®‡§æ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§≤‡§ó ‡§∞‡§π‡§æ ‡§π‡•à ‡§Ø‡§æ ‡§ï‡•Å‡§õ ‡§∏‡•ã‡§ö‡•á‡§Ç?",
      "‡§Ö‡§≠‡•Ä ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ ‡§Æ‡§® ‡§ï‡§ø‡§∏ ‡§§‡§∞‡§´‡§º ‡§π‡•à?"
    ]
  };

  /* ===============================
     GENERIC FORWARD (FALLBACK)
     =============================== */
  const GENERIC_FORWARD = [
    "‡§Ö‡§≠‡•Ä ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ ‡§Æ‡§® ‡§ï‡§ø‡§∏ ‡§ì‡§∞ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à?",
    "‡§Ö‡§≠‡•Ä ‡§§‡•Å‡§Æ‡•ç‡§π‡•á‡§Ç ‡§ï‡•ç‡§Ø‡§æ ‡§†‡•Ä‡§ï ‡§≤‡§ó‡•á‡§ó‡§æ?"
  ];

  function pick(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }

  /* ===============================
     MAIN GENERATOR ‚Äî SINGLE FORWARD
     =============================== */
  function generate(userText) {
    // 1) ‡§π‡§≤‡•ç‡§ï‡•Ä ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ (‡§è‡§ï)
    const reaction = pick(REACTIONS);

    // 2) Soft MiniPlan ‡§∏‡•á inclination (‡§Ö‡§ó‡§∞ ‡§π‡•ã)
    const miniPlan = global.AnjaliMiniPlan
      ? global.AnjaliMiniPlan.getContext()
      : null;

    let forward;

    if (
      miniPlan &&
      miniPlan.inclination &&
      FORWARD_BY_INCLINATION[miniPlan.inclination]
    ) {
      forward = pick(FORWARD_BY_INCLINATION[miniPlan.inclination]);
    } else {
      forward = pick(GENERIC_FORWARD);
    }

    // üîí SINGLE FORWARD RULE: ‡§¨‡§∏ ‡§Ø‡§π‡•Ä ‡§¨‡•ã‡§≤‡•á‡§ó‡•Ä
    return `${reaction} ${forward}`;
  }

  /* ===============================
     EXPORT
     =============================== */
  global.AnjaliResponseGenerator = {
    generate
  };

})(window);
